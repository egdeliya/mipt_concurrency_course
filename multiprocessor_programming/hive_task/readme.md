Работа с распределенной базой данных HIVE. Запросы на языке sql. 

Как проходит работа
0) Заходим на сервер через ssh, вводим логин и пароль
1) Запросы пишутся в файле
2) Первым действием создаем metastore (или по-другому database, создание места, где будет храниться таблица) посредством запуска файла init.sql. Путь к database необходимо сменить в соответствие с логином
3)   Файл запускается на выполнение командой 
hive -f /path_to_file/init.sql
4)   Создать файл типа name_of_file.sql
	а) создать таблицу (разметка столбцов)
	б) «заполнить» ее данными из файлов в hdfs
	в) выполнить запросы поверх созданной таблицы
5)   Выполнить файл командой
hive -f /path_to_file/name_of_file.sql

Описание данных находится в файле Описание данных для запуска:)

Задания:

Задача 1. Создайте внешние (EXTERNAL) таблицы по исходным данным. В результате будет три таблицы: логи пользователей, данные ip адресов, данные пользователей. Требуется, чтобы сериализация и десериализация данных осуществлялась с использованием регулярных выражений. Проверить правильность создания таблиц с помощью простейших запросов (SELECT * FROM <table> LIMIT 10).

Задача 2. Напишите запрос, выбирающий количество хитов для каждого дня. Полученные результаты отсортировать.

Задача 3. Выберите регионы, в которых количество хитов выше среднего количества хитов по всем регионам. 

Задача 4. Напишите запрос, выбирающий количество хитов от мужчин и от женщин по регионам.

Задача 5. Создать UDF «перевертыш». Функция принимает строку и возвращает данную строку записанную в обратном порядке. Подключите данную функцию к hive и выполните выборку «перевертышей» для ip адресов.

Задача 6. Представьте ситуацию, что все новостные сайты переехали в домен .com. Вас попросили создать представление, в котором логи пользователей будут указывать не на старые домены, а на новые. Например, новостная ссылка http://news.rambler.ru/8744806 теперь должна выглядеть в ваших запросах как http://news.rambler.com/8744806. Для создания такого представления используйте стриминг в hive-sql запросе. (Рекомендуется обратить внимание на команды в awk и sed).
