Нахождение интеграла с использованием нитей Posix

Постановка задачи.
Найти двойной интеграл от заданной функции по определенной области

Решить определенный интеграл 
(1) методом Монте-Карло.

Задание:
1) Получить значение двойного интеграла с использованием общей переменной, в которую несколько нитей записывают свои результаты расчетов. Доступ к общей переменной обеспечить через критическую секцию.
2) Построить график зависимость ускорения S от количества нитей p для суммарного количества случайных точек равного 10^9.
3)* Получить  значение  интеграла  с  использованием механизма возврата значения из функции нити (pthread_exit – pthread_join).

